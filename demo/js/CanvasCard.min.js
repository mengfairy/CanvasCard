(function(e,b){"function"===typeof define&&(define.amd||define.cmd)?define(b):e.CanvasCard=b()})(this,function(){var e=function(b){try{document.createElement("canvas").getContext("2d")}catch(a){return alert("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u522e\u522e\u5361\u529f\u80fd"),!1}if(!(b.element&&b.bgPic&&b.upPic&&document.getElementById(b.element)))return!1;this.option=b;this.initCanvas(!0)};e.prototype={eventBind:function(){function b(a){a.preventDefault();f=!0}
    function a(a){a.preventDefault();f=!1}function d(a){a.preventDefault();f&&(a.changedTouches&&(a=a.changedTouches[a.changedTouches.length-1]),c.drawPoint(a.clientX+document.body.scrollLeft-c.canvas.offsetLeft,a.clientY+document.body.scrollTop-c.canvas.offsetTop))}var c=this,f=!1;c.canvas.addEventListener("touchstart",b);c.canvas.addEventListener("touchend",a);c.canvas.addEventListener("touchmove",d);c.canvas.addEventListener("mousedown",b);c.canvas.addEventListener("mouseup",a);c.canvas.addEventListener("mousemove",
        d);window.addEventListener("resize",function(){clearTimeout(c.time);c.time=setTimeout(c.initCanvas.bind(c),300)},!1)},drawPoint:function(b,a){this.cxt.globalCompositeOperation="destination-out";this.cxt.beginPath();var d=this.cxt.createRadialGradient(b,a,0,b,a,30);d.addColorStop(0,"rgba(0,0,0,1)");d.addColorStop(1,"rgba(255, 255, 255, 0)");this.cxt.fillStyle=d;this.cxt.arc(b,a,30,0,2*Math.PI,!0);this.cxt.closePath();this.cxt.fill()},initCanvas:function(b){console.log(b);var a=this,d=new Image,c=document.getElementById(a.option.element),
    f=c.offsetWidth,e=c.offsetHeight;d.src=a.option.upPic;a.canvas=c.getElementsByTagName("canvas")[0];if(!a.canvas){var g=document.createElement("canvas");c.appendChild(g);a.canvas=g}a.canvas.setAttribute("width",f+"px");a.canvas.setAttribute("height",e+"px");a.canvas.style.backgroundImage="url('"+a.option.bgPic+"')";a.canvas.style.backgroundColor="transparent";a.canvas.style.backgroundSize="cover";a.canvas.style.backgroundRepeat="no-repeat";a.canvas.style.backgroundPosition="center";d.onload=function(){a.cxt=
    a.canvas.getContext("2d");a.cxt.drawImage(d,0,0,d.width,d.height,0,0,f,e);b?a.eventBind():null}}};return e});
